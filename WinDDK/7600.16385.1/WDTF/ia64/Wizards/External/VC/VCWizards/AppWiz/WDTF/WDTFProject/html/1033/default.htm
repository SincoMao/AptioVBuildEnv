<!- Copyright (c) Microsoft Corporation. All rights reserved. -->
<HTML DIR="LTR">
	<HEAD>
		<TITLE>WDTF COM-DLL Project Wizard</TITLE>
		<META NAME="vs_targetSchema" CONTENT="http://schemas.microsoft.com/intellisense/ie5">
		<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
		<META HTTP-EQUIV="MSThemeCompatible" CONTENT="Yes">
		<LINK ID="LINKURL" REL="stylesheet" HREF="../../../../../1033/NewStyles.css">
		<SYMBOL NAME="SAFE_PROJECT_IDENTIFIER_NAME" TYPE="text"></SYMBOL>
		<SYMBOL NAME="UPPER_CASE_SAFE_PROJECT_IDENTIFIER_NAME" TYPE="text"></SYMBOL>
		<SYMBOL NAME="LIB_NAME" TYPE="text"></SYMBOL>
		<SYMBOL NAME="DLL_APP" TYPE="checkbox" VALUE="true"></SYMBOL>
		<SYMBOL NAME="EXE_APP" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="SERVICE_APP" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="MERGE_PROXY_STUB" TYPE="checkbox" VALUE="true"></SYMBOL>
		<SYMBOL NAME="SUPPORT_MFC" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="SUPPORT_WDKBUILD" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="SUPPORT_TRACING" TYPE="checkbox" VALUE="true"></SYMBOL>
		<SYMBOL NAME="SUPPORT_COMPLUS" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="SUPPORT_COMPONENT_REGISTRAR" TYPE="checkbox" VALUE="false"></SYMBOL>
		<SYMBOL NAME="COMPREG_REGISTRY_FORMAT" TYPE="text"></SYMBOL>
		<SYMBOL NAME="LIBID_REGISTRY_FORMAT" TYPE="text"></SYMBOL>
		<SYMBOL NAME="APPID_REGISTRY_FORMAT" TYPE="text"></SYMBOL>
		<SYMBOL NAME="YEAR" TYPE="text"></SYMBOL>
		<SYMBOL NAME="ATTRIBUTED" TYPE="checkbox" VALUE="false"></SYMBOL>
	</HEAD>
	<BODY BGCOLOR="BUTTONFACE" TOPMARGIN="0" LEFTMARGIN="0" RIGHTMARGIN="0" BOTTOMMARGIN="0" ONLOAD="InitDocument(document);" ONKEYDOWN="if (!bValidating) OnKey();" ONKEYPRESS="if (!bValidating) OnPress();">
		<TABLE CLASS="ONE" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
			<COL WIDTH="178">
			<COL>
			<!--OPEN OF INTRODUCTORY INFORMATION TABLE//-->
			<TR VALIGN="TOP">
				<TD HEIGHT="79" WIDTH="100%" COLSPAN="2">
					<TABLE CLASS="TWO" BORDER="0" CELLPADDING="0" CELLSPACING="0">
						<COL WIDTH="12">
						<COL>
						<COL WIDTH="12">
						<TR>
							<TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
								&nbsp;
							</TD>
							<TD VALIGN="TOP" HEIGHT="12">
								&nbsp;
							</TD>
							<TD VALIGN="TOP" HEIGHT="12" WIDTH="12">
								&nbsp;
							</TD>
							<TD CLASS="IMAGE" VALIGN="BOTTOM" WIDTH="110" ROWSPAN="2">
								<DIV CLASS="SMALLA" ID="Layer0">
									<IMG CLASS="SMALLEST" SRC="../../Images/ATL_1.gif" WIDTH="63" HEIGHT="63" ALT="" BORDER="0">
								</DIV>
							</TD>
							<TD VALIGN="TOP" HEIGHT="12" WIDTH="6" ROWSPAN="2">
								&nbsp;
							</TD>
						</TR>
						<TR>
							<TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
								&nbsp;
							</TD>
							<TD VALIGN="TOP" HEIGHT="65">
								<H4 CLASS="HEAD" ID="HEAD">Welcome to the WDTF COM-DLL Project Wizard</H4>
								<P CLASS="SUBHEAD" ID="SUBHEAD">This wizard generates an ATL project with the 
									capability to export implementations of WDTF interfaces.</P>
							</TD>
							<TD VALIGN="TOP" HEIGHT="65" WIDTH="12">
								&nbsp;
							</TD>
						</TR>
						<TR>
							<TD VALIGN="TOP" CLASS="RULE" COLSPAN="5" HEIGHT="2">
								<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
									<TR VALIGN="TOP">
										<TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
										<TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
									</TR>
								</TABLE>
							</TD>
						</TR>
					</TABLE>
				</TD>
			</TR>
			<!--CLOSE OF INTRODUCTORY INFORMATION TABLE//-->
			<!--OPEN OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
			<TR VALIGN="TOP">
				<TD CLASS="Three" VALIGN="TOP" HEIGHT="100%" WIDTH="100%">
					<TABLE CLASS="fixedSize" HEIGHT="100%" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
						<TR VALIGN="TOP">
							<TD CLASS="threeCustom" VALIGN="TOP">
								<!--OPEN OF NAVIGATION TABLE//-->
								<TABLE CLASS="THREE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
									<COL WIDTH="12">
									<COL WIDTH="166">
									<COL WIDTH="1">
									<TR>
										<TD VALIGN="TOP" COLSPAN="3" HEIGHT="12">
											&nbsp;
										</TD>
									</TR>
									<TR>
										<TD VALIGN="TOP" HEIGHT="100%">
											&nbsp;
										</TD>
										<TD VALIGN="TOP" HEIGHT="100%">
											<!--OPEN OF NAVIGATIONAL LINKS//-->
											<DIV CLASS="LINKSELECTED">
												<SPAN CLASS="VERTLINE1"><IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
												</SPAN><SPAN CLASS="HORILINE1">
													<TABLE WIDTH="167" HEIGHT="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0">
														<TR VALIGN="TOP">
															<TD CLASS="DOTTEDLINE" HEIGHT="1">
															</TD>
														</TR>
														<TR VALIGN="TOP">
															<TD HEIGHT="100%">
																<IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="28" ALT="" BORDER="0">
															</TD>
														</TR>
														<TR VALIGN="TOP">
															<TD CLASS="DOTTEDLINE" HEIGHT="1">
															</TD>
														</TR>
													</TABLE>
												</SPAN>
												<TABLE WIDTH="160" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXTSELECTED">
													<TR VALIGN="MIDDLE">
														<TD WIDTH="100%">
				<SPAN ID="Default" TITLE="Examine an overview of selections.">Overview</SPAN>
														</TD>
														<TD WIDTH="4">
															<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
														</TD>
													</TR>
												</TABLE>
											</DIV>
											<DIV CLASS="LINK">
												<TABLE WIDTH="100%" HEIGHT="28" BORDER="0" CELLPADDING="0" CELLSPACING="0" CLASS="LINKTEXT">
													<TR VALIGN="MIDDLE">
														<TD WIDTH="100%">
				<SPAN CLASS="ACTIVELINK" ID="AppSettings" TITLE="Specify the plugin type and feature support for your WDTF project." onClick="Next(document, 'AppSettings.htm');" TABINDEX="1">
																Plugin Settings</SPAN>
														</TD>
														<TD WIDTH="4">
															<IMG SRC="../../Images/spacer.gif" HEIGHT="1" WIDTH="4">
														</TD>
													</TR>
												</TABLE>
											</DIV>
											<!--CLOSE OF NAVIGATIONAL LINKS//-->
										</TD>
										<TD WIDTH="1">
											<DIV CLASS="VERTLINE">
												<IMG SRC="../../Images/spacer.gif" WIDTH="1" HEIGHT="1" ALT="" BORDER="0">
											</DIV>
										</TD>
									</TR>
								</TABLE>
							</TD>
						</TR>
					</TABLE>
					<!--CLOSE OF NAVIGATION TABLE//-->
				</TD>
				<TD VALIGN="TOP" HEIGHT="100%">
					<!--OPEN OF CONTENT AND BUTTON TABLE//-->
					<TABLE CLASS="ONE" BORDER="0" CELLPADDING="0" CELLSPACING="0">
						<COL WIDTH="100%">
						<TR VALIGN="TOP">
							<TD HEIGHT="100%">
								<!--OPEN OF CONTENT//-->
								<TABLE CLASS="CONTENT" BORDER="0" CELLPADDING="0" CELLSPACING="0">
									<COL WIDTH="12">
									<COL WIDTH="398">
									<COL WIDTH="12">
									<TR>
										<TD VALIGN="TOP" HEIGHT="12" COLSPAN="3">
											&nbsp;
										</TD>
									</TR>
									<TR>
										<TD VALIGN="TOP" WIDTH="12">
											&nbsp;
										</TD>
										<TD VALIGN="TOP">
											<SPAN CLASS="ItemTextTop" ID="SETTINGS_SPAN">These are the current project 
												settings:</SPAN>
											<UL>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="APPTYPE" TITLE=""><LABEL FOR="APPTYPE"></LABEL></SPAN>
												</LI>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="ATTRIBUTEDAPP" TITLE=""><LABEL FOR="ATTRIBUTEDAPP"></LABEL>
													</SPAN>
												</LI>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="MERGEPS" TITLE=""><LABEL FOR="MERGEPS"></LABEL></SPAN>
												</LI>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="MFCSUPPORT" TITLE=""><LABEL FOR="MFCSUPPORT"></LABEL>
													</SPAN>
												</LI>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="WDKBUILDSUPPORT" TITLE=""><LABEL FOR="WDKBUILDSUPPORT"></LABEL>
													</SPAN>
												</LI>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="TRACINGSUPPORT" TITLE=""><LABEL FOR="TRACINGSUPPORT"></LABEL>
													</SPAN>
												</LI>
												<LI CLASS="LIST">
													<SPAN CLASS="SideBtnHidden" ID="COMPLUSSUPPORT" TITLE=""><LABEL FOR="COMPLUSSUPPORT"></LABEL>
													</SPAN>
												</LI>
											</UL>
											<SPAN CLASS="ItemText" ID="FinishText">Click <B>Finish</B> from any window to 
												accept the current settings.</SPAN>
											<P CLASS="ElementSpacer2">&nbsp;</P>
											<SPAN CLASS="ItemText" ID="README_REMINDER" TITLE="">After you create the project, 
												see the project's readme.txt file for information about the project features 
												and files that are generated.</SPAN>
										</TD>
										<TD VALIGN="TOP" WIDTH="12">
											&nbsp;
										</TD>
									</TR>
								</TABLE>
								<!--CLOSE OF CONTENT//-->
							</TD>
						</TR>
						<TR VALIGN="BOTTOM">
							<TD HEIGHT="48">
								<!--OPEN OF BUTTON HTML//-->
								<TABLE HEIGHT="48" BORDER="0" CELLPADDING="0" CELLSPACING="0">
									<COL WIDTH="12">
									<COL>
									<COL WIDTH="75">
									<COL WIDTH="4">
									<COL WIDTH="75">
									<COL WIDTH="4">
									<COL WIDTH="75">
									<COL WIDTH="12">
									<TR>
										<TD VALIGN="TOP" CLASS="RULE" COLSPAN="8" HEIGHT="2">
											<TABLE BORDER="0" WIDTH="100%" HEIGHT="1" CELLPADDING="0" CELLSPACING="0">
												<TR VALIGN="TOP">
													<TD HEIGHT="1" WIDTH="100%" BGCOLOR="BUTTONSHADOW"></TD>
													<TD HEIGHT="1" WIDTH="1" BGCOLOR="WINDOW"></TD>
												</TR>
											</TABLE>
										</TD>
									</TR>
									<TR>
										<TD VALIGN="TOP" HEIGHT="11" COLSPAN="8">
											&nbsp;
										</TD>
									</TR>
									<TR>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
											&nbsp;
										</TD>
										<TD VALIGN="TOP" HEIGHT="23">
											&nbsp;
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
											<BUTTON CLASS="BUTTONS" ID="FinishBtn" onClick="OnFinish(document);">Finish</BUTTON>
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
											&nbsp;
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
											<BUTTON CLASS="BUTTONS" ID="CancelBtn" onClick="window.external.Finish(document, 'cancel');">
												Cancel</BUTTON>
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="4">
											&nbsp;
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="75">
											<BUTTON CLASS="BUTTONS" ID="HelpBtn" onClick="window.external.OnHelp('vc.appwiz.atl.com.overview');">
												Help</BUTTON>
										</TD>
										<TD VALIGN="MIDDLE" HEIGHT="23" WIDTH="12">
											&nbsp;
										</TD>
									</TR>
									<TR>
										<TD VALIGN="TOP" HEIGHT="12" COLSPAN="8">
											&nbsp;
										</TD>
									</TR>
								</TABLE>
								<!--CLOSE OF BUTTON HTML//-->
							</TD>
						</TR>
					</TABLE>
					<!--CLOSE OF NAVIGATION, CONTENT, AND BUTTON TABLES//-->
				</TD>
			</TR>
		</TABLE>
	</BODY>
</HTML>
<SCRIPT LANGUAGE="JSCRIPT">

var tab_array = new Array();
tab_array[0] = Default;
tab_array[1] = AppSettings;

function InitDocument(document)
{
	setDirection();
	
	if (window.external.FindSymbol("DOCUMENT_FIRST_LOAD"))
	{
		var L_WizardDialogTitle_Text = "WDTF COM-DLL Project Wizard";
		window.external.AddSymbol("WIZARD_DIALOG_TITLE", L_WizardDialogTitle_Text);
		var strProjName = window.external.FindSymbol("PROJECT_NAME");
		var coll = document.all.tags("SYMBOL");
		var numSymbols = coll.length;
		for (i = 0; i < numSymbols; i++)
		{
			var obj = coll(i);
			if (typeof(obj.VALUE) == "undefined")
			{
				obj.VALUE = getval(obj, strProjName);
			}
		}
		SetLocaleForResources(window.external.GetHostLocale());
		window.external.SetDefaults(document);
		CreateGuids();
	}
    //If user selected project name Atl or Win --> generated classes CAtlModule (CWinApp)
    //are reserved. Therefore rename to CAtl1Module and CWin1App in this case.
    var strSafeProjName = window.external.FindSymbol("SAFE_PROJECT_IDENTIFIER_NAME");
    var strAtlModuleClassName=ConstructClassName(strSafeProjName,"Module");
    window.external.AddSymbol("SAFE_ATL_MODULE_NAME", strAtlModuleClassName);
    var strMFCAppClassName=ConstructClassName(strSafeProjName,"App");    
    window.external.AddSymbol("SAFE_MFC_APP_NAME", strMFCAppClassName);    
    
	window.external.Load(document);
	InitControls();
}

function CreateGuids()
{
	strGuid = window.external.CreateGuid();
	strVal = window.external.FormatGuid(strGuid, 0);
	window.external.AddSymbol("LIBID_REGISTRY_FORMAT", strVal);
	strGuid = window.external.CreateGuid();
	strVal = window.external.FormatGuid(strGuid, 0);
	window.external.AddSymbol("APPID_REGISTRY_FORMAT", strVal);
	strGuid = window.external.CreateGuid();
	strVal = window.external.FormatGuid(strGuid, 0);
	window.external.AddSymbol("COMPREG_REGISTRY_FORMAT", strVal);
}

function InitControls()
{
	var L_APPTYPEDLL_Text = "Dynamic-Link Library";
	var L_APPTYPEEXE_Text = "Executable";
	var L_APPTYPESRV_Text = "Service";
	if (window.external.FindSymbol("EXE_APP"))
		APPTYPE.innerText = L_APPTYPEEXE_Text;
	else
	{
		if (window.external.FindSymbol("SERVICE_APP"))
			APPTYPE.innerText = L_APPTYPESRV_Text;
		else
			APPTYPE.innerText = L_APPTYPEDLL_Text;
	}

	var L_NONATTRIBUTEDAPP_Text = "Nonattributed";
	var L_ATTRIBUTEDAPP_Text = "Attributed";
	if (window.external.FindSymbol("ATTRIBUTED"))
		ATTRIBUTEDAPP.innerText = L_ATTRIBUTEDAPP_Text;
	else 
		ATTRIBUTEDAPP.innerText = L_NONATTRIBUTEDAPP_Text;

	MERGEPS.parentNode.style.display = 'none';
	if (window.external.FindSymbol("MERGE_PROXY_STUB") && !window.external.IsSymbolDisabled("MERGE_PROXY_STUB"))
	{
		var L_MERGPS_Text = "Proxy/stub merging";
		MERGEPS.innerText = L_MERGPS_Text;
		MERGEPS.parentNode.style.display = 'block';
	}

	MFCSUPPORT.parentNode.style.display = 'none';
	if (window.external.FindSymbol("SUPPORT_MFC") && !window.external.IsSymbolDisabled("SUPPORT_MFC"))
	{
		var L_MFCSUPPORT_Text = "MFC support";
		MFCSUPPORT.innerText = L_MFCSUPPORT_Text;
		MFCSUPPORT.parentNode.style.display = 'block';
	}

	WDKBUILDSUPPORT.parentNode.style.display = 'none';
	if (window.external.FindSymbol("SUPPORT_WDKBUILD") && !window.external.IsSymbolDisabled("SUPPORT_WDKBUILD"))
	{
		var L_WDKBUILDSUPPORT_Text = "WDK/Windows Build Environment Support";
		WDKBUILDSUPPORT.innerText = L_WDKBUILDSUPPORT_Text;
		WDKBUILDSUPPORT.parentNode.style.display = 'block';
	}

	TRACINGSUPPORT.parentNode.style.display = 'none';
	if (window.external.FindSymbol("SUPPORT_TRACING") && !window.external.IsSymbolDisabled("SUPPORT_TRACING"))
	{
		var L_TRACINGSUPPORT_Text = "WPP Tracing Support";
		TRACINGSUPPORT.innerText = L_TRACINGSUPPORT_Text;
		TRACINGSUPPORT.parentNode.style.display = 'block';
	}

	COMPLUSSUPPORT.parentNode.style.display = 'none';
	if (window.external.FindSymbol("SUPPORT_COMPLUS") && !window.external.IsSymbolDisabled("SUPPORT_COMPLUS"))
	{
		var L_COMPLUSSUPPORT_Text = "COM+ 1.0 support";
		COMPLUSSUPPORT.innerText = L_COMPLUSSUPPORT_Text;
		COMPLUSSUPPORT.parentNode.style.display = 'block';
	}
}

function Next(document, linkto)
{
	window.external.Next(document, linkto);
}

function OnFinish(document)
{
	OnWizFinish(document);
}

function getval(obj, strProjName)
{
	var SymbolValue = "";
	switch(obj.NAME)
	{
		case "SAFE_PROJECT_IDENTIFIER_NAME":
			SymbolValue	= CreateASCIIName(strProjName);
			break;
		case "UPPER_CASE_SAFE_PROJECT_IDENTIFIER_NAME":
			{
				var strSafeProjName = CreateSafeName(strProjName);
				SymbolValue = strSafeProjName.toUpperCase();
			}
			break;
		case  "LIB_NAME":
			{
				var strSafeLibName = CreateIdentifierSafeName(strProjName);
				for (n=0;n<10;n++)
				{
					if (strSafeLibName.substr(0,1) == n.toString())
						strSafeLibName = "My" + strSafeLibName;
				}
				SymbolValue = strSafeLibName;
			}
			break;
		case  "YEAR":
			{
				d = new Date();
				SymbolValue = d.getFullYear().toString();
			}
			break;
		default:
			SymbolValue = "";
			break;
	}
	return (SymbolValue);
}

</SCRIPT>
<SCRIPT ID="INCLUDE_SCRIPT" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT ID="INCLUDE_COMMON" LANGUAGE="JSCRIPT"></SCRIPT>
<SCRIPT>
	document.scripts("INCLUDE_SCRIPT").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Script.js";
	document.scripts("INCLUDE_COMMON").src = window.external.FindSymbol("SCRIPT_COMMON_PATH") + "/Common.js";
</SCRIPT>
